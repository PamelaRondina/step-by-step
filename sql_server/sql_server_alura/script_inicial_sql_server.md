-- SCRIPT INICIAL

-- CRIAR TABELA
CREATE TABLE [PAM_CLIENTES]
([CPF] [VARCHAR] (11),
[NOME] [VARCHAR] (100),
[ENDERECO1] [VARCHAR] (150),
[ENDERECO2] [VARCHAR] (150),
[BAIRRO] [VARCHAR] (50),
[CIDADE] [VARCHAR] (50),
[ESTADO] [VARCHAR] (2),
[CEP] [VARCHAR] (8),
[DATA_NASCIMENTO] [DATE],
[IDADE] [SMALLINT],
[SEXO] [VARCHAR] (1),
[LIMITE_CREDITO] [MONEY],
[VOLUME_COMPRA] [FLOAT],
[PRIMEIRA_COMPRA] [BIT]);

CREATE TABLE [VENDEDORES]
([MATRICULA] [VARCHAR] (5),
[NOME] [VARCHAR] (100),
[PERCENTUAL COMISSAO] FLOAT);

-- INSERIR REGISTROS NA TABELA
INSERT INTO [TABELA DE VENDEDORES]
([MAtRICULA], [NOME], [PERCENTUAL COMISSÃO])
VALUES
('00235','Márcio Almeida Silva',0.08);

INSERT INTO [TABELA DE VENDEDORES]
([MAtRICULA], [NOME], [PERCENTUAL COMISSÃO])
VALUES
('00236','Cláudia Morais',0.08);

-- ALTERAR REGISTROS NA TABELA
UPDATE [dbo].[PRODUTOS]
SET [EMBALAGEM] = 'Lata',
[PRECO_DE_LISTA] = 2.46 
WHERE CODIGO_DO_PRODUTO = '544931'

UPDATE [dbo].[VENDEDORES] 
SET [NOME] = '	Cláudia Moraes Sousa' WHERE MATRICULA = '00236'

-- EXCLUIR
-- EXCLUIR - TABELA
DROP TABLE [dbo].[PRODUTOS];
DROP TABLE [PAM_CLIENTES];

-- EXCLUIR - CAMPO
ALTER TABLE MODELO_TESTE DROP COLUMN TELEFONE2;

-- EXCLUIR - REGISTRO
DELETE FROM [dbo].[PRODUTOS] WHERE CODIGO_DO_PRODUTO = '1037797';

-- ADICIONAR CHAVE PRIMÁRIA
ALTER TABLE [dbo].[VENDEDORES] ADD CONSTRAINT PK_VENDEDORES PRIMARY KEY CLUSTERED (MATRICULA)

-- ADICIONAR NOT NUULL IN NULL
ALTER TABLE [dbo].[VENDEDORES] ALTER COLUMN MATRICULA VARCHAR(5) NOT NULL;

-- ADICIONAR COLUNA/CAMPO
ALTER TABLE CADASTRO_CLIENTES ADD COLUMN (DATA_NASCIMENTO DATE);

-- ADICIONAR NOME FANTASIA PARA O CAMPO (AS)
SELECT	CPF AS CPF_CLIENTE,  NOME AS NOME_CLIENTE FROM [dbo].[CLIENTES]


-- SELECIONAR QUANTOS CAMPOS DESEJÁVEIS NA ORDEM DE CAMPO ESCOLHIDO (ORDER BY)
SELECT ID, NOME FROM CADASTRO_CLIENTES ORDER BY NOME;

-- SELECIONAR UM LIMITE ESPECIFICO (LIMIT)
SELECT ID, NOME FROM CADASTRO_CLIENTES LIMIT 1;

-- SELECIONAR ALGUNS CAMPOS
SELECT * FROM [dbo].[PRODUTOS] WHERE SABOR = 'Limão'

-- LÓGICA

-- AUMENTAR VALORES EM 10%
UPDATE [dbo].[PRODUTOS] SET PRECO_DE_LISTA = 1.1 * PRECO_DE_LISTA WHERE SABOR = 'Limão'

SELECT * FROM [dbo].[PRODUTOS] where sabor = 'Limão'

-- SELECIONAR REGISTROS > < = <> <diferente>
SELECT * FROM CADASTRO_CLIENTES WHERE ID = 1;
SELECT * FROM CADASTRO_CLIENTES WHERE ID < 3;
SELECT * FROM VENDEDORES WHERE PERCENTUAL_COMISSAO > 0.10;
SELECT * FROM CADASTRO_CLIENTES WHERE ID >= 2;
SELECT * FROM CADASTRO_CLIENTES WHERE ID <> 1;

-- SELECIONAR VALORES ENTRE (BETWEEN)
--SELECT * FROM MODELO_TESTE WHERE DATA_NASCIMENTO BETWEEN '01/01/79' AND '01/01/22';

--NOT não aparece o que estou puxando
--SELECT * FROM MODELO_TESTE WHERE NOT (DATA_NASCIMENTO = '19/10/1985' AND NOME = 'João Nascimento'); 

-- SELECIONADO DATAS (AAAA-MM-DD)
SELECT * FROM VENDEDORES WHERE DATA_ADMISSAO < '1985-10-19';
SELECT * FROM VENDEDORES WHERE DATA_ADMISSAO > '1985-10-19';
SELECT * FROM VENDEDORES WHERE DATA_ADMISSAO = '1985-10-19';
SELECT * FROM VENDEDORES WHERE DATA_ADMISSAO <> '1985-10-19';

SELECT * FROM CADASTRO_CLIENTES WHERE YEAR (DATA_NASCIMENTO) = 2000;
SELECT * FROM CADASTRO_CLIENTES WHERE MONTH (DATA_NASCIMENTO) = 03;
SELECT * FROM CADASTRO_CLIENTES WHERE DAY (DATA_NASCIMENTO) = 12;
SELECT * FROM VENDEDORES WHERE FERIAS = 1 AND YEAR (DATA_ADMISSAO) < 2016;


--visualizar operações lógicas AND, OR e IN
SELECT * FROM MODELO_TESTE WHERE ID > 1 AND ID   3;
SELECT * FROM MODELO_TESTE WHERE ID >= 1 AND ID <= 3;
SELECT * FROM MODELO_TESTE WHERE ESTADO = 'RJ' OR ESTADO = 'SP';
SELECT * FROM MODELO_TESTE WHERE ESTADO IN ('RJ', 'MG');

-- VISUALIZAR TABELAS
SELECT * FROM [dbo].[VENDEDORES] WHERE [PERCENTUAL COMISSAO] = '00239' 
SELECT * FROM [dbo].[PRODUTOS] where sabor = 'Limão'

-- --DISTINCT 
-- Visualizar resultados sem repetição (quais são as embalagens com líquido sabor laranja?)
SELECT DISTINCT EMBALAGEM FROM [dbo].[PRODUTOS] WHERE SABOR = 'Laranja';

--ROWNUM (NÃO EXECUTADO!)
-- Escolho a quantidade de itens que a tabela deve informar
SELECT * FROM [dbo].[CLIENTES] WHERE ROWNUM <=4
-- O RESULTADO SERÃO AS 4 PRIMEIRAS LINHAS DA TABELA

-- (NAO EXECUTADO) LISTAR AS 10 PRIMEIRAS VENDAS DO DIA 01/10/17
SELECT * FROM [dbo].[CLIENTES] WHERE [DATA_NASCIMENTO] = 
TO_DATE('2017-01-01','YYYY-MM-DD') AND ROWNUM <= 10;


-- ORDER BY ASC
-- organiza DO MENOR para o MAIOR (Ascendente)
SELECT * FROM [dbo].[VENDEDORES] ORDER BY NOME;
SELECT * FROM [dbo].[VENDEDORES] ORDER BY  NOME ASC;

-- ORDER BY DESC
-- organiza do MAIOR para o MENOR (Descendente)
SELECT * FROM [dbo].[VENDEDORES] ORDER BY  NOME DESC;

--GROUP BY
-- SE POSSUIR 'ORDER BY' A 'GROUP BY' DEVE VIR ANTES
-- SUM (soma), AVG (média), MAX (máximo), MIN (mínimo), COUNT(CONTA)

SELECT CIDADE, SUM(IDADE) SOMA_DAS_IDADES FROM [dbo].[CLIENTES] GROUP BY CIDADE ORDER BY CIDADE;

-- QUAIS SÃO OS PRODUTOS MAIS CAROS?
SELECT EMBALAGEM, MAX(PRECO_DE_LISTA) AS MAIOR_PRECO FROM [dbo].[PRODUTOS] GROUP BY EMBALAGEM;

-- HAVING
-- VEM DEPOIS DO GROUP BY, É UTILIZADO COMO UM FILTRO

SELECT EMBALAGEM, MAX(PRECO_DE_LISTA) AS MAIOR_PRECO FROM [dbo].[PRODUTOS]
WHERE PRECO_DE_LISTA >= 10
GROUP BY EMBALAGEM
HAVING MAX(PRECO_DE_LISTA) >=5;


-- LISTAR RESULTDADOS DAS TABELAS
SELECT * FROM [dbo].[PRODUTOS]
SELECT * FROM [dbo].[CLIENTES]
SELECT * FROM [dbo].[VENDEDORES]
